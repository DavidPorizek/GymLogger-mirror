@page "/equipments"
@inject Data.ApiService apiService
@using GymLogger.Shared.Models

<h3>Equipments</h3>

@if (equipments == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <EditForm Model="@equipmentModel" OnValidSubmit="@HandleValidSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <InputText id="name" @bind-Value="equipmentModel.Name" />
        <InputNumber id="barbellmin" @bind-Value="equipmentModel.BarbellMin" />
        <InputNumber id="BarbellMax" @bind-Value="equipmentModel.BarbellMax" />
        <InputNumber id="BarbellIncrements" @bind-Value="equipmentModel.BarbellIncrements" />
        <InputNumber id="DumbbellMin" @bind-Value="equipmentModel.DumbbellMin" />
        <InputNumber id="DumbbellMax" @bind-Value="equipmentModel.DumbbellMax" />
        <InputNumber id="DumbbellIncrements" @bind-Value="equipmentModel.DumbbellIncrements" />


        <button type="submit">Submit</button>
    </EditForm>

    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Barbell Minimum</th>
                <th>Barbell Maximum</th>
                <th>Barbell Increments</th>
                <th>Dumbbell Minimum</th>
                <th>Dumbbell Maximum</th>
                <th>Dumbbell Increments</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var equipment in equipments)
            {
                <tr>
                    <td>@equipment.Id</td>
                    <td>@equipment.Name</td>
                    <td>@equipment.BarbellMin</td>
                    <td>@equipment.BarbellMax</td>
                    <td>@equipment.BarbellIncrements</td>
                    <td>@equipment.DumbbellMin</td>
                    <td>@equipment.DumbbellMax</td>
                    <td>@equipment.DumbbellIncrements</td>
                </tr>
            }
        </tbody>
    </table>
}

@code {
    private Equipment equipmentModel = new();
    List<Equipment>? equipments = new();

    protected override async Task OnInitializedAsync()
    {
        equipments = await apiService.GetEquipmentsAsync();
    }

    private async void HandleValidSubmit()
    {
        await apiService.CreateEquipmentAsync(equipmentModel);
    }
}